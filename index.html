<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>rn4 Tournament</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --blue:#5eead4;
  --gold:#fde047;
}
*{box-sizing:border-box;font-family:Inter,Arial}

body{
  margin:0;
  background:radial-gradient(circle at top,#0b1c3d,#020617);
  color:white;
  padding:20px;
}

h1{
  text-align:center;
  letter-spacing:8px;
  margin-bottom:5px;
}
.sub{text-align:center;opacity:.7;margin-bottom:25px}

.panel{
  max-width:1100px;
  margin:auto;
  background:linear-gradient(145deg,#0b1c3d,#020617);
  border-radius:20px;
  padding:20px;
  box-shadow:0 20px 40px rgba(0,0,0,.7);
}

.grid-2{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:15px;
}

label{font-weight:700;margin-top:10px;display:block}
textarea,select,input{
  width:100%;
  margin-top:6px;
  padding:10px;
  border-radius:10px;
  border:none;
  background:#020617;
  color:white;
}
textarea{min-height:120px}

.stats{margin-top:10px;font-size:14px;opacity:.8}

button{
  width:100%;
  margin-top:15px;
  padding:14px;
  font-weight:900;
  border:none;
  border-radius:14px;
  cursor:pointer;
  background:linear-gradient(135deg,var(--blue),#7cffd4);
  color:#001018;
}

.toggle{
  display:flex;
  align-items:center;
  gap:10px;
  margin-top:10px;
}

/* ===== TOURNAMENT ===== */
.tournament{
  margin-top:40px;
  display:grid;
  grid-template-columns:1fr auto 1fr;
  gap:25px;
  align-items:center;
}

.mid-title{
  text-align:center;
  font-weight:900;
  color:var(--gold);
  letter-spacing:6px;
}

.column{
  display:flex;
  flex-direction:column;
  gap:20px;
}

/* CARD */
.card{
  background:linear-gradient(160deg,#13255a,#020617);
  border-radius:18px;
  padding:14px;
  box-shadow:0 15px 35px rgba(0,0,0,.6);
  cursor:pointer;
}
.card h3{
  margin:0;
  color:var(--gold);
  text-align:center;
}
.content{
  display:none;
  margin-top:10px;
}
.card.open .content{display:block}

.member{
  opacity:0;
  transform:translateX(-6px);
  animation:enter .4s ease forwards;
}
@keyframes enter{
  to{opacity:1;transform:none}
}

.L{color:#38bdf8}
.P{color:#f472b6}

.copy-btn{
  margin-top:20px;
  background:linear-gradient(135deg,#fde047,#f59e0b);
  color:#3b2100;
}

/* Responsive */
@media(max-width:900px){
  .tournament{grid-template-columns:1fr}
}
</style>
</head>

<body>

<h1>RN4</h1>
<div class="sub">Tournament Mode</div>

<div class="panel">
  <div class="grid-2">
    <div>
      <label>Nama Laki-laki</label>
      <textarea id="male" placeholder="contoh:
andi
ikan
ayam"></textarea>
    </div>
    <div>
      <label>Nama Perempuan</label>
      <textarea id="female" placeholder="contoh:
siti
ayu
bunga"></textarea>
    </div>
  </div>

  <div class="stats" id="stats">L: 0 | P: 0 | Total: 0</div>

  <label>Jumlah Kelompok</label>
  <select id="groupCount"></select>

  <div class="toggle">
    <input type="checkbox" id="ruleMale" checked>
    <label>Maksimal laki-laki per kelompok</label>
  </div>

  <input type="number" id="maxMale" value="3" min="0">

  <button onclick="generate()">âš¡ GENERATE TOURNAMENT</button>
</div>

<div class="panel">
  <button class="copy-btn" onclick="copyAll()">ðŸ“‹ COPY HASIL</button>
</div>

<div class="tournament" id="tournament"></div>

<!-- SOUND -->
<audio id="sGenerate" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>
<audio id="sOpen" src="https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3"></audio>

<script>
const maleEl=document.getElementById("male");
const femaleEl=document.getElementById("female");
const stats=document.getElementById("stats");

function updateStats(){
  const m=maleEl.value.split("\n").filter(x=>x.trim());
  const f=femaleEl.value.split("\n").filter(x=>x.trim());
  stats.innerText=`L: ${m.length} | P: ${f.length} | Total: ${m.length+f.length}`;
}
maleEl.oninput=femaleEl.oninput=updateStats;
updateStats();

const gc=document.getElementById("groupCount");
for(let i=2;i<=10;i++) gc.innerHTML+=`<option>${i}</option>`;

function shuffle(a){
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
}

function generate(){
  document.getElementById("sGenerate").play();

  let males=maleEl.value.split("\n").filter(x=>x).map(n=>({n,g:"L"}));
  let females=femaleEl.value.split("\n").filter(x=>x).map(n=>({n,g:"P"}));

  let students=[...males,...females];
  shuffle(students);

  const gCount=+gc.value;
  const rule=document.getElementById("ruleMale").checked;
  const maxMale=+document.getElementById("maxMale").value;

  let groups=Array.from({length:gCount},()=>[]);
  let maleCount=Array(gCount).fill(0);

  let idx=0;
  students.forEach(s=>{
    let tries=0;
    while(tries<gCount){
      let gi=idx%gCount;
      if(!rule || s.g==="P" || maleCount[gi]<maxMale){
        groups[gi].push(s);
        if(s.g==="L") maleCount[gi]++;
        idx++;
        break;
      }
      idx++; tries++;
    }
  });

  render(groups);
}

function render(groups){
  const t=document.getElementById("tournament");
  t.innerHTML="";

  let left=document.createElement("div");
  left.className="column";
  let right=document.createElement("div");
  right.className="column";

  groups.forEach((g,i)=>{
    let html=g.map((s,j)=>`
      <div class="member" style="animation-delay:${j*0.15}s">
        ${j+1}. ${s.n} (${s.g})
      </div>`).join("");

    let card=document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <h3>KELOMPOK ${i+1}</h3>
      <div class="content">${html}</div>
    `;
    card.onclick=()=>{
      card.classList.toggle("open");
      document.getElementById("sOpen").play();
    };

    (i%2===0?left:right).appendChild(card);
  });

  let mid=document.createElement("div");
  mid.className="mid-title";
  mid.innerHTML="RN4";

  t.append(left,mid,right);
}

function copyAll(){
  let text="";
  document.querySelectorAll(".card").forEach((c,i)=>{
    text+=`Kelompok ${i+1}:\n`;
    c.querySelectorAll(".member").forEach(m=>{
      text+=m.innerText+"\n";
    });
    text+="\n";
  });
  navigator.clipboard.writeText(text);
  alert("Hasil dicopy!");
}
</script>

</body>
</html>